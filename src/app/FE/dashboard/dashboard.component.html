<div class="dashboard-layout">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-left">
      <img src="/assets/images/LOGO_DHXD.png" alt="HUCE Logo" class="header-logo">
      <div class="header-title">
        <h1>TRƯỜNG ĐẠI HỌC XÂY DỰNG</h1>
        <p>National University of Civil Engineering</p>
      </div>
    </div>
    <div class="header-right">
      <div class="user-info">
        <div class="user-avatar" (click)="toggleUserDropdown()">
          <i class="user-icon">👤</i>
        </div>
        
        <!-- User Dropdown Menu -->
        <div class="user-dropdown" *ngIf="showUserDropdown" (click)="$event.stopPropagation()">
          <div class="user-profile">
            <div class="profile-avatar">
              <i class="profile-icon">👤</i>
            </div>
            <div class="profile-info">
              <h4 class="profile-name">{{ getUserDisplayName() }}</h4>
              <p class="profile-email">{{ currentUser?.email || currentUser?.username }}</p>
              <p class="profile-role">{{ currentUser?.role || 'Người dùng' }}</p>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-actions">
            <button class="dropdown-item" (click)="navigateTo('Cài đặt'); closeUserDropdown()">
              <i class="item-icon">⚙️</i>
              Cài đặt tài khoản
            </button>
            <button class="dropdown-item logout-item" (click)="logout()">
              <i class="item-icon">🚪</i>
              Đăng xuất
            </button>
          </div>
        </div>
        
        <button class="logout-btn-simple" (click)="logout()" title="Đăng xuất">
          🚪
        </button>
      </div>
    </div>
  </header>

  <div class="dashboard-body">
    <!-- Sidebar -->
    <nav class="sidebar" [class.collapsed]="sidebarCollapsed">
      <button class="menu-toggle" (click)="toggleSidebar()">☰ Menu</button>
      <ul class="nav-menu">
        <li class="nav-item" [class.active]="currentPage === 'Tổng quan'">
          <a href="#" class="nav-link" (click)="navigateTo('Tổng quan'); $event.preventDefault()">
            <i class="nav-icon">🏠</i>
            <span class="nav-text">Tổng quan</span>
          </a>
        </li>
        <li class="nav-item" [class.active]="currentPage === 'KPI được giao'" *ngIf="isPhoHieuTruong()">
          <a href="#" class="nav-link" (click)="navigateToMyKpis(); $event.preventDefault()">
            <i class="nav-icon">📋</i>
            <span class="nav-text">KPI được giao</span>
          </a>
        </li>
        <li class="nav-item" [class.active]="currentPage === 'KPI đã tạo'">
          <a href="#" class="nav-link" (click)="navigateTo('KPI đã tạo'); $event.preventDefault()">
            <i class="nav-icon">📊</i>
            <span class="nav-text">KPI đã tạo</span>
          </a>
        </li>
        <li class="nav-item" [class.active]="currentPage === 'Tạo KPIs'">
          <a href="#" class="nav-link" (click)="navigateTo('Tạo KPIs'); $event.preventDefault()">
            <i class="nav-icon">📈</i>
            <span class="nav-text">Tạo KPIs</span>
          </a>
        </li>
        <li class="nav-item" [class.active]="currentPage === 'Cài đặt'">
          <a href="#" class="nav-link" (click)="navigateTo('Cài đặt'); $event.preventDefault()">
            <i class="nav-icon">⚙️</i>
            <span class="nav-text">Cài đặt</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <div class="breadcrumb">
          <span class="breadcrumb-item">🏠 Trang chủ</span>
          <span class="breadcrumb-separator">▶</span>
          <span class="breadcrumb-item current">{{ currentPage }}</span>
        </div>
      </div>

      <div class="content-area">
        <!-- Tổng quan Page -->
        <div class="welcome-section" *ngIf="currentPage === 'Tổng quan'">
          <div class="welcome-avatar">
            <div class="avatar-circle">
              <i class="avatar-icon">👤</i>
            </div>
          </div>
          
          <h2 class="welcome-title">Xin chào, {{ getUserDisplayName() }}</h2>
          
          <p class="welcome-message">Chào mừng bạn đến với hệ thống KPI của Trường Đại học Xây dựng</p>
        </div>

        <!-- KPI Đã tạo -->
        <div class="page-content" *ngIf="currentPage === 'KPI đã tạo'">
          <app-unit-kpi-view (navigateToCreate)="navigateTo('Tạo KPIs')"></app-unit-kpi-view>
        </div>

        <!-- Tạo KPIs Page -->
        <div class="page-content" *ngIf="currentPage === 'Tạo KPIs'">
          <app-create-kpi></app-create-kpi>
        </div>

        <!-- KPI được giao Page -->
        <div class="page-content" *ngIf="currentPage === 'KPI được giao'">
          <app-assigned-kpi-view></app-assigned-kpi-view>
        </div>

        <!-- Cài đặt Page -->
        <div class="page-content" *ngIf="currentPage === 'Cài đặt'">
          <div class="info-card">
            <h3 class="card-title">⚙️ Cài đặt Hệ thống</h3>
            <div class="info-content">
              <div class="info-text">
                <p><strong>Tùy chọn cài đặt:</strong></p>
                <p>• Quản lý tài khoản người dùng</p>
                <p>• Cấu hình thông số KPI</p>
                <p>• Thiết lập quyền truy cập</p>
                <p>• Cài đặt thông báo</p>
                <p>• Backup và khôi phục dữ liệu</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>